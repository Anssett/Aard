<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Saturday, June 08, 2019, 1:41 PM -->
<!-- MuClient version 5.06-pre -->

<!-- Plugin "BonusLootComparison" generated by Plugin Wizard -->

<muclient>
<plugin
   name="BonusLootComparison"
   author="Algaru"
   id="69976a7041679016450bd971"
   language="Lua"
   purpose="Provide information about bonus loot flags"
   date_written="2019-06-08 13:41:09"
   requires="5.06"
   version="1.0"
   >
<description trim="y">
<![CDATA[
Use this tool to look up how useful a particular bonusloot flag is, 
or to compare two flags against each other.

  bloot                     display a table of known bonus loot flags
  bloot <flag>              display information about which tier a particular flag is in
  bloot <flag1> <flag2>     tell you which flag is better, and how far apart they are. 
]]>
</description>

</plugin>


<!--  Get our standard constants -->

<include name="constants.lua"/>

<!--  Plugin help  -->

<aliases>
    <alias
     script="OnHelp"
     match="bloot help"
     enabled="y"
    >
    </alias>
	<alias
	match="^[ ]*bloot[ ]*$"
	regexp="y"
	enabled="y"
	sequence="100"
	script="listAll"
	>
	</alias>

	<alias
	match="^[ ]*bloot[ ]*([A-Za-z]+)[ ]*$"
	regexp="y"
	enabled="y"
	sequence="100"
	script="listOne"
	>
	</alias>

    <alias
	match="^[ ]*bloot[ ]*([A-Za-z]+)[ ]+([A-Za-z]+)[ ]*$"
	regexp="y"
	enabled="y"
	sequence="100"
	script="compareTwo"
	>
	</alias>
</aliases>

<script>
<![CDATA[

flaglist = {
	"Polished",
	"Enhanced",
	"Burnished",
	"Shiny",
	"Vibrant",
	"Sparkling",
	"Gleaming",
	"Shimmering",
	"Dazzling",
	"Brilliant",
	"Majestic",
	"Radiant",
	"Wondrous",
	"Exalted",
	"Eternal",
	"Mythical",
	"Epic",
	"Legendary",
	"Fabled",
	"Godly"
}

function OnHelp ()
  world.Note (world.GetPluginInfo (world.GetPluginID (), 3))
end

function listAll ()
	ColourNote("magenta", "", "Listing all bonus loot flags in order (worst to best)")
	printTable()
end

function listOne(name, line, args)
	inputVal = string.lower(args[1])
	index = getIndex(inputVal)

	if index == nil then
		ColourNote("magenta", "", "No entry found for input " .. inputVal)
		return
	end

	bonusflag = flaglist[index]	
	ColourNote("magenta", "", "'" .. bonusflag .. "' is the tier " .. index .. " flag."  )
	printTable(index)
		
end

function compareTwo(name, line, args)
	a = string.lower(args[1])
	b = string.lower(args[2])
	
	indexa = getIndex(a)
	indexb = getIndex(b)
	
	if indexa == nil then
		ColourNote("magenta", "", "No entry found for input " .. a)
		return
	end
	
	if indexb == nil then
		ColourNote("magenta", "", "No entry found for input " .. b)
		return
	end
	
	flaga = flaglist[indexa]
	flagb = flaglist[indexb]

	if (indexa == indexb) then
		ColourNote("magenta", "", "'" .. flaga .. "' was passed in twice!"  )
	elseif (indexa < indexb) then
		diff = indexb - indexa
		ColourNote("magenta", "", "'" .. flagb .. "' is " .. diff .. " tiers higher than '" .. flaga .. "'.")
	else
		diff = indexa - indexb
		ColourNote("magenta", "", "'" .. flaga .. "' is " .. diff .. " tiers higher than '" .. flagb .. "'.")
	end	
	
	printTable(indexa, indexb)
end

function getIndex(input)
	for index, flag in pairs(flaglist) do
		lowerflag = string.lower(flag)
		if (lowerflag == input) or (string.sub(lowerflag, 1, string.len(input)) == input) then
			return index
		end
	end
	
	return nil
end

function printTable(a, b)
	i = 1
	
	while i < #flaglist + 1 do
		prefix = "   "
		prefcolor = "white"
		pcolor = "red"
		name = flaglist[i] or ""
		
		if i < 12 then
			pcolor = "green"
		end
		
		if a and a == i then
			prefix = " * "
		end
		
		if b and b == i then
			prefix = " * "
		end
		
		ColourNote(prefcolor, "", prefix, pcolor, "", "(", "white", "", name, pcolor, "", ")")
		i = i + 1
	end
end
]]>
</script> 

</muclient>
