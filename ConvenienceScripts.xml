<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Sunday, January 20, 2019, 9:31 AM -->
<!-- MuClient version 5.06-pre -->

<!-- Plugin "ConvenienceScripts" generated by Plugin Wizard -->

<muclient>
<plugin
   name="AlgaruConvenienceScripts"
   author="Algaru"
   id="3d0a536e1264c566c50247b8"
   language="Lua"
   purpose="Collection of useful tools"
   date_written="2019-01-20 09:31:18"
   version="1.0"
   >

</plugin>

<!--  Get our standard constants -->

<include name="constants.lua"/>

<triggers>
  <trigger
   enabled="n"
   match="^You are charged .* gold clan skill fee.$"
   regexp="y"
   name="earthtouch_success"
   script="earthtouch_success"
   sequence="100"
   group="EarthtouchTriggers"
  >
  </trigger>
  <trigger
   enabled="n"
   match="^Oh no!! You just changed .* into a rubber chicken!$"
   regexp="y"
   name="earthtouch_failure"
   script="earthtouch_stop"
   sequence="100"
   group="EarthtouchTriggers"
  >
  </trigger>
  <trigger
   enabled="n"
   match="Damage Type : (?<dtype>[^\s]+)"
   regexp="y"
   name="earthtouch_dtype"
   script="earthtouch_dtype"
   sequence="100"
   group="EarthtouchTriggers"
  >
  </trigger>
</triggers>

<aliases>
  <alias
   match="^#(?<count>\d*) (?<command>.*)$"
   enabled="y"
   expand_variables="y"
   regexp="y"
   send_to="12"
   sequence="100"
   script="repeat_command"
  >
  </alias>

  <alias match="^et (?<et_item>.*)" 
    enabled="y" 
    expand_variables="y" 
    regexp="y"
    sequence="100" 
    send_to='12'
    script="earthtouch_command" >  
  </alias>  

  
</aliases>


<script>
<![CDATA[
    function repeat_command (name, line, wildcards)
        count = tonumber(wildcards.count)
        command = wildcards.command
    
        if (count < 0 or count > 10)
        then
            print("INVALID VALUE")
            return
        end
        
        local index = 0
        while (index < count) do
            Send(command)
            index = index + 1
        end
        
    end -- repeat_command
    
    
    --  Earthtouch Helpers -- 
    function earthtouch_command (name, line, args)
        et_item = args.et_item
        SetVariable("et_item", et_item)
        SaveState()
        EnableTriggerGroup("EarthtouchTriggers", true)
        Send("earthtouch '" .. et_item .. "'")
    end
	
    function earthtouch_success ()
        et_item = GetVariable("et_item")
        Send("identify '" .. et_item .. "'")
    end
    
    function earthtouch_dtype(name, line, args)
        dtype = args.dtype
        SendNoEcho("echo *** Damage type set to @R" .. dtype .. "@w. *** ")
        earthtouch_stop()
    end
    
    function earthtouch_stop ()
        EnableTriggerGroup("EarthtouchTriggers", false)
        SetVariable("et_item", "")
        SaveState()
    end
    
    -- End of Earthtouch Helpers -- 

]]>
</script>

</muclient>
